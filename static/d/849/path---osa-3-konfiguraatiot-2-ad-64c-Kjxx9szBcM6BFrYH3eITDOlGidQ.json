{"data":{"markdownRemark":{"html":"<div class=\"content\">\n<h3>Lint</h3>\n<p>Ennen osan lopetusta katsomme vielä nopeasti paitsioon jäänyttä tärkeää työkalua <a href=\"https://en.wikipedia.org/wiki/Lint_(software)\">lintiä</a>. Wikipedian sanoin:</p>\n<blockquote>\n<p>Generically, lint or a linter is any tool that detects and flags errors in programming languages, including stylistic errors. The term lint-like behavior is sometimes applied to the process of flagging suspicious language usage. Lint-like tools generally perform static analysis of source code.</p>\n</blockquote>\n<p>Staattisesti tyypitetyissä, käännettävissä kielissä esim. Javassa ohjelmointiympäristöt, kuten NetBeans osaavat huomautella monista koodiin liittyvistä asioista, sellaisistakin, jotka eivät ole välttämättä käännösvirheitä. Erilaisten <a href=\"https://en.wikipedia.org/wiki/Static_program_analysis\">staattisen analyysin</a> lisätyökalujen, kuten <a href=\"http://checkstyle.sourceforge.net/\">checkstylen</a> avulla voidaan vielä laajentaa Javassa huomautettavien asioiden määrää koskemaan koodin tyylillisiä seikkoja, esim. sisentämistä.</p>\n<p>Javascript-maailmassa tämän hetken johtava työkalu staattiseen analyysiin, eli \"linttaukseen\" on <a href=\"https://eslint.org/\">ESlint</a>.</p>\n<p>Asennetaan ESlint backendiin kehitysaikaiseksi riippuvuudeksi komennolla</p>\n<pre><code class=\"language-bash\">npm install eslint --save-dev\n</code></pre>\n<p>Tämän jälkeen voidaan muodostaa alustava ESlint-konfiguraatio komennolla</p>\n<pre><code class=\"language-bash\">node_modules/.bin/eslint --init\n</code></pre>\n<p>Vastaillaan kysymyksiin:</p>\n<picture><img src=\"/static/e9f3b752ee16b9ee300b5093157a9aa7/14be6/24.png\" srcset=\"/static/e9f3b752ee16b9ee300b5093157a9aa7/4cce7/24.png 200w,\n/static/e9f3b752ee16b9ee300b5093157a9aa7/bae5f/24.png 400w,\n/static/e9f3b752ee16b9ee300b5093157a9aa7/14be6/24.png 800w,\n/static/e9f3b752ee16b9ee300b5093157a9aa7/1b35a/24.png 1200w,\n/static/e9f3b752ee16b9ee300b5093157a9aa7/156ce/24.png 1364w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Konfiguraatiot tallentuvat tiedostoon <em>.eslintrc.js</em>:</p>\n<pre><code class=\"language-js\">module.exports = {\n    \"env\": {\n        \"node\": true\n        \"es6\": true\n    },\n    \"extends\": \"eslint:recommended\",\n    \"rules\": {\n        \"indent\": [\n            \"error\",\n            4\n        ],\n        \"linebreak-style\": [\n            \"error\",\n            \"unix\"\n        ],\n        \"quotes\": [\n            \"error\",\n            \"single\"\n        ],\n        \"semi\": [\n            \"error\",\n            \"never\"\n        ]\n    }\n};\n</code></pre>\n<p>Muutetaan heti konfiguraatioista sisennystä määrittelevä sääntö, siten että sisennystaso on 2 välilyöntiä</p>\n<pre><code>\"indent\": [\n    \"error\",\n    2\n],\n</code></pre>\n<p>Esim tiedoston <em>index.js</em> tarkastus tapahtuu komennolla</p>\n<pre><code class=\"language-bash\">node_modules/.bin/eslint index.js\n</code></pre>\n<p>Kannattaa ehkä tehdä linttaustakin varten <em>npm-skripti</em>:</p>\n<pre><code class=\"language-bash\">{\n  // ...\n  \"scripts\": {\n    \"start\": \"node index.js\",\n    \"watch\": \"nodemon index.js\",\n    \"lint\": \"eslint .\"\n  },\n  // ...\n}\n</code></pre>\n<p>Nyt komennot <em>npm run lint</em> suorittaa tarkastukset koko projektille.</p>\n<p>Myös hakemistossa <em>build</em> oleva frontendin tuotantoversio tulee näin tarkastettua. Sitä emme kuitenkaan halua, eli tehdään projektin juureen tiedosto <a href=\"https://eslint.org/docs/user-guide/configuring#ignoring-files-and-directories\">.eslintignore</a> ja sille seuraava sisältö</p>\n<pre><code class=\"language-bash\">build\n</code></pre>\n<p>Näin koko hakemiston <em>build</em> sisältö jätetään huomioimatta linttauksessa.</p>\n<p>Lintillä on jonkin verran huomautettavaa koodistamme:</p>\n<picture><img src=\"/static/e82a45b883d6b87447d05d49ab19a25a/14be6/22.png\" srcset=\"/static/e82a45b883d6b87447d05d49ab19a25a/4cce7/22.png 200w,\n/static/e82a45b883d6b87447d05d49ab19a25a/bae5f/22.png 400w,\n/static/e82a45b883d6b87447d05d49ab19a25a/14be6/22.png 800w,\n/static/e82a45b883d6b87447d05d49ab19a25a/1b35a/22.png 1200w,\n/static/e82a45b883d6b87447d05d49ab19a25a/de095/22.png 1478w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Ei kuitenkaan korjata ongelmia vielä.</p>\n<p>Parempi vaihtoehto kuin linttauksen suorittaminen komentoriviltä on konfiguroida editorille <em>lint-plugin</em>, joka suorittaa linttausta koko ajan. Näin pääset korjaamaan pienet virheet välittömästi. Tietoja esim. Visual Studion ESlint-pluginsta <a href=\"https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint\">täällä</a>.</p>\n<p>VS Coden ESlint-plugin alleviivaa tyylisääntöjä rikkovat kohdat punaisella:</p>\n<picture><img src=\"/static/9412b815bddceabce6e74658ca7a04ec/14be6/23.png\" srcset=\"/static/9412b815bddceabce6e74658ca7a04ec/4cce7/23.png 200w,\n/static/9412b815bddceabce6e74658ca7a04ec/bae5f/23.png 400w,\n/static/9412b815bddceabce6e74658ca7a04ec/14be6/23.png 800w,\n/static/9412b815bddceabce6e74658ca7a04ec/1b35a/23.png 1200w,\n/static/9412b815bddceabce6e74658ca7a04ec/2f0e8/23.png 1386w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Näin ongelmat on helppo korjata koodiin heti.</p>\n<p>ESlintille on määritelty suuri määrä <a href=\"https://eslint.org/docs/rules/\">sääntöjä</a>, joita on helppo ottaa käyttöön muokkaamalla tiedostoa <em>.eslintrc.js</em>.</p>\n<p>Otetaan käyttöön sääntö <a href=\"https://eslint.org/docs/rules/eqeqeq\">eqeqeq</a> joka varoittaa, jos koodissa yhtäsuuruutta verrataan muuten kuin käyttämällä kolmea = -merkkiä. Sääntö lisätään konfiguraatiotiedostoon kentän <em>rules</em> alle.</p>\n<pre><code class=\"language-bash\">\"rules\": {\n  // ...\n  \"eqeqeq\": \"error\"\n},\n</code></pre>\n<p>Tehdään samalla muutama muukin muutos tarkastettaviin sääntöihin.</p>\n<p>Estetään rivien lopussa olevat <a href=\"https://eslint.org/docs/rules/no-trailing-spaces\">turhat välilyönnit</a>, vaaditaan että <a href=\"https://eslint.org/docs/rules/object-curly-spacing\">aaltosulkeiden edessä/jälkeen on aina välilyönti</a> ja vaaditaan myös konsistenttia välilyöntien käyttöä <a href=\"https://eslint.org/docs/rules/arrow-spacing\">nuolifunktioiden parametrien suhteen</a>:</p>\n<pre><code class=\"language-bash\">\"rules\": {\n  // ...\n  \"eqeqeq\": \"error\",\n  \"no-trailing-spaces\": \"error\",\n  \"object-curly-spacing\": [\n      \"error\", \"always\"\n  ],\n  \"arrow-spacing\": [\n      \"error\", { \"before\": true, \"after\": true }\n  ]\n},\n</code></pre>\n<p>Oletusarvoinen konfiguraatiomme ottaa käyttöön joukon valmiiksi määriteltyjä sääntöjä <em>eslint:recommended</em></p>\n<pre><code class=\"language-bash\">\"extends\": \"eslint:recommended\",\n</code></pre>\n<p>Mukana on myös <em>console.log</em>-komennoista varoittava sääntö-\nYksittäisen sääntö on helppo kytkeä <a href=\"https://eslint.org/docs/user-guide/configuring#configuring-rules\">pois päältä</a> määrittelemällä sen \"arvoksi\" konfiguraatiossa 0. Tehdään toistaiseksi näin säännölle <em>no-console</em>.</p>\n<pre><code class=\"language-bash\">\"rules\": {\n  // ...\n  \"eqeqeq\": \"error\",\n  \"no-trailing-spaces\": \"error\",\n  \"object-curly-spacing\": [\n      \"error\", \"always\"\n  ],\n  \"arrow-spacing\": [\n      \"error\", { \"before\": true, \"after\": true }\n  ],\n  \"no-console\": 0\n},\n</code></pre>\n<p><strong>HUOM</strong> kun teet muutoksia tiedostoon <em>.eslintrc.js</em>, kannattaa muutosten jälkeen suorittaa linttaus komentoriviltä ja varmistaa että konfiguraatio ei ole viallinen:</p>\n<picture><img src=\"/static/c2122fc083e051499aeefe1565eb101d/14be6/25.png\" srcset=\"/static/c2122fc083e051499aeefe1565eb101d/4cce7/25.png 200w,\n/static/c2122fc083e051499aeefe1565eb101d/bae5f/25.png 400w,\n/static/c2122fc083e051499aeefe1565eb101d/14be6/25.png 800w,\n/static/c2122fc083e051499aeefe1565eb101d/1b35a/25.png 1200w,\n/static/c2122fc083e051499aeefe1565eb101d/c6ea5/25.png 1506w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jos konfiguraatiossa on jotain vikaa, voi editorin lint-plugin näyttää mitä sattuu.</p>\n<p>Monissa yrityksissä on tapana määritellä yrityksen laajuiset koodausstandardit ja näiden käyttöä valvova ESlint-konfiguraatio. Pyörää ei kannata välttämättä keksiä uudelleen ja voi olla hyvä idea ottaa omaan projektiin joku käyttöön jossain muualla hyväksi havaittu konfiguraatio. Viime aikoina monissa projekteissa on omaksuttu AirBnB:n <a href=\"https://github.com/airbnb/javascript\">Javascript</a>-tyyliohjeet ottamalla käyttöön firman määrittelemä <a href=\"https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb\">ESLint</a>-konfiguraatio.</p>\n<p>Sovelluksen tämän hetkinen koodi on kokonaisuudessaan <a href=\"https://github.com/FullStack-HY/part3-notes-backend/tree/part3-5\">githubissa</a>, tagissa <em>part3-5</em>.</p>\n<h3>Tehtäviä</h3>\n<p>Tee nyt viimeinen tehtävä <a href=\"/teht%C3%A4v%C3%A4t#eslint\">3.22</a></p>\n</div>","frontmatter":{"title":"osa 3","subTitle":"Konfiguraatiot","path":"/osa3/konfiguraatiot","mainImage":{"publicURL":"/static/osa3-0663ef82a07b48287172672d36835e81.png"},"partColor":"light-orange","part":3,"letter":"d"}}},"pageContext":{}}